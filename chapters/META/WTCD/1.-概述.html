<h1>1. 概述</h1>
<h2>1.1 什么是 WTCD</h2>
<p>WTCD 全名 Wearable Technology's Conditional Document，是琳为《可穿戴科技》项目设计的分支引擎所使用的语言，允许作者非常容易地编写可互动的（带有分支选项的）小说。设计之初是为了满足帕蒂卡的小说的分支需要，之后就发展成了一门完整的语言。</p>
<p>WTCD 是一门“四分之一”编译的语言 —— WTCD 的编译器会将源文件（<code>.wtcd</code>） 解析（parse）成 JSON 格式的 AST，然后由解释器执行（interpret）。</p>
<p>WTCD 是一门不是很弱类型的语言 —— 每一个变量都有指定的类型并且不能存储类型不符合的值。然而 WTCD 的编译器并不会进行类型推断，因此类型错误只会在运行时被丢出。</p>
<p>在 WTCD 中，通常来说代码逻辑和具体小说内容是分开的，以避免在代码之间混入大量影响理解逻辑的小说正文内容。</p>
<p>与大多数语言不同的是。WTCD 是一个没有分隔符的语言 —— 这意味着在 WTCD 中每一个表达式或是申明之后不需要添加分号，甚至在列表的元素之间也不需要添加逗号。需要注意的是，<strong>没有分割符并不代表用换行作为分割</strong>，恰恰相反，对于 WTCD 来说，换行的作用和空格或是 TAB 是完全一致的（除了单行注释，带有换行的字符串以及用 Markdown 编写的正文） —— 多个表达式之间使用空格分割或者换行分割都是可行的，因此 <strong>WTCD 的语句之间（虽然建议，但是）不需要添加换行</strong>。</p>
<h2>1.2 Hello World!</h2>
<p>下面是 WTCD 的 Hello World!：</p>
<pre><code class="language-wtcd">WTCD 1.0
section helloWorld then exit

---&lt;&lt;&lt; helloWorld &gt;&gt;&gt;---
# Hello World!
</code></pre>
<p><a href="#META/WTCD/%E4%BE%8B%E5%AD%90/Hello-World.html">执行效果</a></p>
<h2>1.3 一个更<s>色情</s>复杂的例子</h2>
<p>Hello World! 完全无法演示 WTCD 的任何功能，因此这里给出一个稍微复杂一些的例子：</p>
<pre><code class="language-wtcd">WTCD 1.0
declare [
  boolean vibrator = false
]
section start then selection [
  choice &quot;按下开关&quot; goto press
  choice &quot;不按&quot; goto doNotPress
]
section press {
  vibrator = true
} then goto walkHome
section doNotPress then goto walkHome
section walkHome then vibrator
  ? goto czpClimax
  : goto czpGoToGrandmasHouse
section czpClimax then exit
section czpGoToGrandmasHouse then exit

---&lt;&lt;&lt; start &gt;&gt;&gt;---
# 稍微复杂点的涉及粉红色遥控器的例子
面对少女的背影，手握粉红色遥控器的你，是否要按下开关呢？

---&lt;&lt;&lt; press &gt;&gt;&gt;---
想到手中遥控器能给少女带来的快乐，心善的你毫不犹豫地按下了开关。

然而，出乎意料的是少女似乎丝毫没有被影响。

“可能是没电了吧...”

---&lt;&lt;&lt; doNotPress &gt;&gt;&gt;---
“还是不了吧...”

---&lt;&lt;&lt; walkHome &gt;&gt;&gt;---
这样想着，你把遥控器放进了裤子口袋里，朝家中走去。

---&lt;&lt;&lt; czpClimax &gt;&gt;&gt;---
突然，你远远地看到路边有一只陈志鹏正扶着墙，一脸红晕地走着。你突然明白了什么，然后愤怒地把遥控器调到了最大。

---&lt;&lt;&lt; czpGoToGrandmasHouse &gt;&gt;&gt;---
路上经过了一只陈志鹏。你还没来得及向他打招呼，他就说道：

“好，我要去奶奶家了。”

一脸懵逼的你只得继续向前走着。
</code></pre>
<p><a href="#META/WTCD/%E4%BE%8B%E5%AD%90/%E7%A8%8D%E5%BE%AE%E5%A4%8D%E6%9D%82%E7%82%B9%E7%9A%84%E6%B6%89%E5%8F%8A%E7%B2%89%E7%BA%A2%E8%89%B2%E9%81%A5%E6%8E%A7%E5%99%A8%E7%9A%84%E4%BE%8B%E5%AD%90.html">执行效果</a></p>
<h2>1.5 开始编写 WTCD</h2>
<p>尽管 WTCD 被设计为一个独立的语言，在目前阶段，WTCD 和《可穿戴科技》是捆绑在一起的。若要下载安装使用 WTCD 的编译器和解析器，你需要先安装 <a href="https://nodejs.org/">Node.js</a> 和 <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">git</a>。然后，你需要使用 git 将《可穿戴科技》的 repo 克隆下来：</p>
<pre><code>git clone https://github.com/SCLeoX/Wearable-Technology.git
</code></pre>
<p>克隆完成后，你需要在克隆下来的 repo 文件夹内使用 npm 进行安装并运行脚本 <code>watch</code>：</p>
<pre><code>npm install
npm run watch
</code></pre>
<p>如果一切顺利，该脚本会自动打开一个浏览器窗口并显示你本地版本的《可穿戴科技》。</p>
<p>此时，你可以开始编写 WTCD 文档了。本教程用到的所有例子的源代码都在 <code>chapters/5 - Meta/1 - WTCD/1 - 例子</code> 中。你可以阅读并修改它们。若要创建新的文档，在 <code>chapters</code> 文件夹内创建一个文件名符合《可穿戴科技》标准，后缀为 <code>.wtcd</code> 的文件就可以了（格式为 <code>&lt;显示序号&gt; - &lt;显示名&gt;.wtcd</code>，例如 <code>233 - 哈哈.wtcd</code>）。当你修改任何 <code>chapters</code> 文件夹中的文件时，之前运行的 <code>watch</code> 脚本会自动重新编译你的修改，因此此时无需运行任何命令，只需要刷新浏览器（你可能需要使用 ctrl+F5 来强制刷新）就可以看到修改后的版本了。</p>
<p>另外，若要编写 WTCD 文档，我<strong>强烈建议</strong>你使用 <a href="https://code.visualstudio.com/">Visual Studio Code</a> 并安装 <a href="https://marketplace.visualstudio.com/items?itemName=WTCD.vscode-wtcd">WTCD 的语法高亮插件</a>。如果你不知道的话，Visual Studio Code 是微软写的<em>基本开源</em>轻量编辑器，非常好用。同时，WTCD 目前只提供 Visual Studio Code 的语法高亮插件，而有语法高亮可以显著提升你的编辑体验。</p>
<h2>1.6 版本声明</h2>
<p>每一个 WTCD 文档的开头都是该 WTCD 文档编写时使用 WTCD 版本。其格式如下：</p>
<pre><code class="language-wtcd">WTCD 1.0
</code></pre>
<p>目前版本是 1.0 所以请务必使用 1.0 作为版本。</p>
<p>WTCD 的版本使用 2/3 Semantic Versioning：</p>
<ul>
<li>版本号由两个数字组成，中间用点连接，例如：<code>42.2333</code></li>
<li>点前面的数字是 Major Version（42）</li>
<li>点后面的数字是 Minor Version（2333）</li>
<li>Breaking Change（会导致之前编写的代码无法运行的）会递增 Major Version
<ul>
<li>这包括添加新的保留字或是修改现有操作符的优先级等</li>
</ul>
</li>
<li>增加向后兼容的功能会递增 Minor Version
<ul>
<li>这包括添加新的操作符等</li>
</ul>
</li>
<li>Bug Fixes 不修改版本号</li>
</ul>
<p>为了保证代码简介，之后的例子中将不会包含版本声明。</p>
<h2>1.7 注释</h2>
<p>WTCD 允许作者在单行注释和多行注释。</p>
<pre><code class="language-wtcd">// 单行注释例子
/*
多行
注释
例子
*/
</code></pre>
<p>单行注释以 <code>//</code> 开始持续到当前行末，多行注释则以 <code>/*</code> 开始持续到 <code>*/</code>。注释内的任何内容都不会被读取。</p>
<p>WTCD 不支持多行注释嵌套。</p>
